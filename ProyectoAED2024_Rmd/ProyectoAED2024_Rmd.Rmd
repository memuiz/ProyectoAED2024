---
title: Título
author:
 - name: Alejandro León Líndez
   affil: 1
 - name: Adrian Lizzadro Pla
   affil: 2
 - name: Marta Medina Muñiz
   affil: 3
affiliation:
  - num: 1
    address: |
      Máster en Ciencia de Datos
    email: alelin@alumni.uv.es
  - num: 2
    address: |
      Máster en Ciencia de Datos
    email: alizpla@alumni.uv.es
  - num: 3
    address: |
      Máster en Ciencia de Datos
    email: memuiz@alumni.uv.es

# document options
journal: notspecified
type: article
status: submit
# front matter
simplesummary: |
  Resumen.
abstract: |
  Abstract
# back matter
keywords: |
  keyword 1; keyword 2; keyword 3 (list three to ten pertinent keywords specific 
                                   to the article, yet reasonably common within the subject discipline.).


abbreviations:
  - short: MDPI
    long: Multidisciplinary Digital Publishing Institute
  - short: DOAJ
    long: Directory of open access journals
  - short: TLA
    long: Three letter acronym
  - short: LD 
    long: linear dichroism
bibliography: mybibfile.bib
appendix: appendix.tex
endnotes: false
output: 
  rticles::mdpi_article:
  extra_dependencies: longtable
---

```{r setup, include=FALSE}
# Setup Chunk
library(here)
library(knitr)

knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = here::here()) # Set working directory a la carpeta del proyecto en lugar de a la sub-cartpeta del Rmd
```
  
# Introducción
  
  
# Carga de librerías e importación del fichero
  
```{r}
rm(list=ls())  # Borrar todas las variables al principio
```
  
```{r}
library(readr)
library(ggplot2)
```


```{r}
viajes <- read_delim("data/viajeros_según_sexo_destino_duracion_del_viaje.csv", delim = ";", escape_double = FALSE, trim_ws = TRUE)
```

```{r}
any(is.na(viajes))  # Comprobación de si hay datos faltantes
```


## Transformar a tidy data
```{r}
tipos_datos <- unique(viajes$`Tipo de dato`)
```


```{r}
viajes_porcentaje_categoria <- subset(viajes,viajes$`Tipo de dato` == tipos_datos[1])
nombres_col_cat <- colnames(viajes_porcentaje_categoria)
nombres_col_cat[nombres_col_cat == "Total"] <-"Porcentaje_personas_categoria"
colnames(viajes_porcentaje_categoria)<-nombres_col_cat
viajes_porcentaje_categoria <- subset(viajes_porcentaje_categoria, select = -`Tipo de dato`)
```


```{r}
viajes_porcentaje_total<- subset(viajes,viajes$`Tipo de dato` == tipos_datos[2])
nombres_col_tot <- colnames(viajes_porcentaje_total)
nombres_col_tot[nombres_col_tot == "Total"] <-"Porcentaje_personas_total"
colnames(viajes_porcentaje_total)<-nombres_col_tot
viajes_porcentaje_total <- subset(viajes_porcentaje_total, select = -`Tipo de dato`)
```


```{r}
# Compruebo que en todas las columnas salvo la última todos las filas son iguales para poder hacer merge de los dos datasets correctamente
any(viajes_porcentaje_categoria[1:length(nrow(viajes_porcentaje_categoria)-1)] !=viajes_porcentaje_total[1:length(nrow(viajes_porcentaje_total)-1)])
```
```{r}
# Uno los dos datasets en un único dataset con el que trabajar

datos <- merge(viajes_porcentaje_categoria,viajes_porcentaje_total, by = c(colnames(viajes_porcentaje_categoria[1:length(viajes_porcentaje_categoria)-1])))
```

## Transformación de clases

```{r}
lapply(datos,class)
```
```{r}
datos$Porcentaje_personas_categoria <-sub(",",".",datos$Porcentaje_personas_categoria)

# Compruebo si se han introducido NA
which(is.na(as.numeric(datos$Porcentaje_personas_categoria))==TRUE)
# Compruebo que dato habia antes de la transformación para poder corregirlo si fuera posible
datos$Porcentaje_personas_categoria[133]
# No es posible corregirlo, es un dato faltante
```

```{r}
datos$Porcentaje_personas_categoria <- as.numeric(datos$Porcentaje_personas_categoria)
```
```{r}
datos$Porcentaje_personas_total<-sub(",",".",datos$Porcentaje_personas_total)

# Compruebo si se han introducido NA
which(is.na(as.numeric(datos$Porcentaje_personas_total))==TRUE)
# Compruebo que dato habia antes de la transformación para poder corregirlo si fuera posible
datos$Porcentaje_personas_total[133]
# No es posible corregirlo, es un dato faltante
```
No hay datos para mujeres que en 2021 se fueron de viaje al extranjero de 1 a 3 noches.


```{r}
datos$Porcentaje_personas_total <- as.numeric(datos$Porcentaje_personas_total)
```
```{r}
# Comprobamos que se hayan transformado correctamente
lapply(datos,class)
```



